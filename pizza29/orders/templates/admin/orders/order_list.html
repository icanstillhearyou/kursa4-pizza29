{% extends "main/base.html" %}
{% load static %}

{% block title %}Управление заказами{% endblock title %}

{% block content %}
    <style>
        .errorlist {
            display: inline-block;
            color: red;
            font-size: 12px;
            margin-left: 10px;
            vertical-align: middle;
            list-style: none;
            padding: 0;
        }
        .errorlist li {
            margin: 0;
        }
        .field-with-error {
            display: inline-flex;
            align-items: center;
            width: 100%;
        }
        .search-form {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .table th, .table td {
            vertical-align: middle;
        }
    </style>
    <div class="container mt-4">
        <h2>Управление заказами</h2>

        <!-- Форма поиска и сортировки -->
        <form method="get" class="search-form">
            {{ form.search_query.label_tag }}
            {{ form.search_query }}
            {{ form.sort_by.label_tag }}
            {{ form.sort_by }}
            <button type="submit" class="btn btn-primary">Применить</button>
        </form>

        <!-- Таблица заказов -->
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>№ Заказа</th>
                    <th>Клиент</th>
                    <th>Email</th>
                    <th>Тип заказа</th>
                    <th>Дата</th>
                    <th>Самовывоз</th>
                    <th>Оплачено</th>
                    <th>Сумма</th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.first_name }} {{ order.last_name }}</td>
                        <td>{{ order.email }}</td>
                        <td>{{ order.get_order_type_display }}</td>
                        <td>{{ order.created|date:"d.m.Y H:i" }}</td>
                        <td>{{ order.is_pickup|yesno:"Да,Нет" }}</td>
                        <td>{{ order.paid|yesno:"Да,Нет" }}</td>
                        <td>{{ order.get_total_cost }} ₽</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="8" class="text-center">Заказы не найдены</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock content %}